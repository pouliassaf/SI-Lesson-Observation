#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon May 12 00:42:10 2025

@author: paulaassaf
"""

import streamlit as st
from openpyxl import load_workbook
from openpyxl.worksheet.worksheet import Worksheet
from datetime import datetime, timedelta, date # Import timedelta and date
import os
import statistics
import pandas as pd # Added for potential analytics use later
import matplotlib.pyplot as plt # Added for potential analytics use later
import csv # Added for potential log download
import math
import io
from openpyxl.utils import get_column_letter # Import get_column_letter

# Import ReportLab modules for PDF generation
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle, Image # Import Image
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import inch
from reportlab.lib import colors
import re # Import regex for cleaning HTML tags

# --- Set Streamlit Page Config (MUST BE THE FIRST STREAMLIT COMMAND) ---
st.set_page_config(page_title="Lesson Observation Tool", layout="wide")

# --- Logo File Paths ---
# Define a dictionary mapping school names to logo file paths
# Ensure these paths are correct relative to your script location
# Add more school logos here as needed
LOGO_PATHS = {
    "Default": "logos/default.jpeg", # Default logo for schools not listed
    "Al Bayan School": "logos/CS_Al Bayan Charter School_Logo.png",
    "Al Bayraq School": "logos/CS_Al Bayraq_Logo_PNG.png",
    "Al Dhaher School": "logos/CS_Al Dhaher_Logo_PNG.png",
    "Al Hosoon School": "logos/CS_Al Hosoon Charter School_Logo.png",
    "Al Mutanabi School": "logos/CS_Al Mutanabi_Logo_PNG.png",
    "Al Nahdha School": "logos/CS_Al Nahdha_Logo_PNG.png",
    "Jern Yafoor School": "logos/CS_Jern Yafoor_Logo_PNG.png",
    "Maryam Bint Omran School": "logos/CS_Maryam Bint Omran_Logo_PNG.png",
    # Add other school logos here following the pattern:
    # "School Name as it appears in the app": "logos/your_logo_file.png",
}

# --- Text Strings for Localization ---
# Ensure all strings used in the UI and feedback are included here and translated
en_strings = {
    "page_title": "Lesson Observation Tool",
    "sidebar_select_page": "Choose a page:",
    "page_lesson_input": "Lesson Observation Input",
    "page_analytics": "Lesson Observation Analytics",
    "title_lesson_input": "Weekly Lesson Observation Input Tool",
    "info_default_workbook": "Using default template workbook:",
    "warning_default_not_found": "Default template workbook '{}' not found. Please upload a workbook.",
    "error_opening_default": "Error opening default template file:",
    "success_lo_sheets_found": "Found {} LO sheets in workbook.",
    "select_sheet_or_create": "Select existing LO sheet or create a new one:",
    "option_create_new": "Create new",
    "success_sheet_created": "Created new sheet: {}",
    "error_template_not_found": "Error: 'LO 1' template sheet not found in the workbook! Cannot create new sheet.",
    "subheader_filling_data": "Filling data for: {}",
    "label_observer_name": "Observer Name",
    "label_teacher_name": "Teacher Name",
    "label_teacher_email": "Teacher Email", # Added from first snippet
    "label_operator": "Operator",
    "label_school_name": "School Name",
    "label_grade": "Grade",
    "label_subject": "Subject",
    "label_gender": "Gender",
    "label_students": "Number of Students",
    "label_males": "Number of Males",
    "label_females": "Number of Females",
    "label_time_in": "Time In",
    "label_time_out": "Time Out",
    "label_lesson_duration": "üïí **Lesson Duration:** {} minutes ‚Äî _{}_",
    "duration_full_lesson": "Full Lesson",
    "duration_walkthrough": "Walkthrough",
    "warning_calculate_duration": "Please enter both 'Time In' and 'Time Out' to calculate duration.", # Added based on snippet 1 logic
    "warning_could_not_calculate_duration": "Could not calculate lesson duration.",
    "label_period": "Period",
    "label_obs_type": "Observation Type",
    "option_individual": "Individual",
    "option_joint": "Joint",
    "subheader_rubric_scores": "Rubric Scores",
    "expander_rubric_descriptors": "Rubric Guidance", # Changed from Descriptors based on snippet 2 text
    "info_no_descriptors": "No rubric guidance available.", # Updated string
    "label_rating_for": "Rating for {}",
    "label_write_notes": "Write notes for {}", # Added string for note input label
    "checkbox_send_feedback": "‚úâÔ∏è Generate Feedback Report (for PDF)", # Renamed to clarify it's for PDF
    "button_save_observation": "üíæ Save Observation",
    "warning_fill_essential": "Please fill in all essential information before saving.", # Added validation warning
    "success_data_saved": "Observation data saved to workbook.", # Simplified message
    "error_saving_workbook": "Error saving workbook:",
    "download_workbook": "üì• Download updated workbook",
    "feedback_subject": "Lesson Observation Feedback", # From snippet 1
    "feedback_greeting": "Dear {},\n\nYour lesson observation from {} has been saved.\n\n", # From snippet 1
    "feedback_observer": "Observer: {}\n", # From snippet 1
    "feedback_duration": "Duration: {}\n", # From snippet 1
    "feedback_subject_fb": "Subject: {}\n", # From snippet 1
    "feedback_school": "School: {}\n\n", # From snippet 1
    "feedback_summary_header": "Here is a summary of your ratings based on the rubric:\n\n", # From snippet 1
    "feedback_domain_header": "**{}: {}**\n", # Domain number and title - From snippet 1
    "feedback_element_rating": "- **{}:** Rating **{}**\n", # Element label and rating - From snippet 1
    "feedback_descriptor_for_rating": "  *Guidance for rating {}:* {}\n", # Descriptor for specific rating - Updated text
    "feedback_overall_score": "\n**Overall Average Score:** {:.2f}\n\n", # From snippet 1
    "feedback_domain_average": "  *Domain Average:* {:.2f}\n", # From snippet 1
    "feedback_performance_summary": "**Performance Summary:**\n", # Header for performance summary - From snippet 1
    "overall_performance_level_text": "Overall Performance Level: {}", # Added string for overall level
    "feedback_domain_performance": "{}: {}\n", # Domain performance level - From snippet 1
    "feedback_support_plan_intro": "\n**Support Plan Recommended:**\n", # Intro for support plan - From snippet 1
    "feedback_next_steps_intro": "\n**Suggested Next Steps:**\n", # Intro for next steps - From snippet 1
    "feedback_closing": "\nBased on these ratings, please review your updated workbook for detailed feedback and areas for development.\n\n", # From snippet 1
    "feedback_regards": "Regards,\nSchool Leadership Team", # From snippet 1
    "success_feedback_generated": "Feedback generated (simulated):\n\n", # From snippet 1
    "success_feedback_log_updated": "Feedback log updated.", # Simplified message
    "error_updating_log": "Error updating feedback log in workbook:", # From snippet 1
    "title_analytics": "Lesson Observation Analytics Dashboard", # From snippet 1
    "warning_no_lo_sheets_analytics": "No 'LO ' sheets found in the workbook for analytics.", # From snippet 1
    "subheader_avg_score_overall": "Average Score per Domain (Across all observations)", # From snippet 1
    "info_no_numeric_scores_overall": "No numeric scores found across all observations to calculate overall domain averages.", # From snippet 1
    "subheader_data_summary": "Observation Data Summary", # From snippet 1
    "subheader_filter_analyze": "Filter and Analyze",
    "filter_by_school": "Filter by School", # From snippet 1
    "filter_by_grade": "Filter by Grade", # From snippet 1
    "filter_by_subject": "Filter by Subject", # From snippet 1
    "option_all": "All", # From snippet 1
    "subheader_avg_score_filtered": "Average Score per Domain (Filtered)", # From snippet 1
    "info_no_numeric_scores_filtered": "No observations matching the selected filters contain numeric scores for domain averages.", # From snippet 1
    "subheader_observer_distribution": "Observer Distribution (Filtered)", # From snippet 1
    "info_no_observer_data_filtered": "No observer data found for the selected filters.", # From snippet 1
    "info_no_observation_data_filtered": "No observation data found for the selected filters.", # From snippet 1
    "error_loading_analytics": "Error loading or processing workbook for analytics:", # From snippet 1
    "overall_score_label": "Overall Score:", # From snippet 1
    "overall_score_value": "**{:.2f}**", # From snippet 1
    "overall_score_na": "**N/A**", # From snippet 1
    "arabic_toggle_label": "ÿπÿ±ÿ∂ ÿ®ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Display in Arabic)", # From snippet 1
    "feedback_log_sheet_name": "Feedback Log", # From snippet 1
    "feedback_log_header": ["Sheet", "Observer", "Teacher", "Email", "School", "Subject", "Date", "Overall Judgment", "Overall Score", "Summary Notes"], # Updated log headers
    "download_feedback_log_csv": "üì• Download Feedback Log (CSV)", # From snippet 1
    "error_generating_log_csv": "Error generating log CSV:", # From snippet 1
    "download_overall_avg_csv": "üì• Download Overall Domain Averages (CSV)", # From snippet 1
    "download_overall_avg_excel": "üì• Download Overall Domain Averages (Excel)", # From snippet 1
    "download_filtered_avg_csv": "üì• Download Filtered Domain Averages (CSV)", # From snippet 1
    "download_filtered_avg_excel": "üì• Download Filtered Domain Averages (Excel)", # From snippet 1
    "download_filtered_data_csv": "üì• Download Filtered Observation Data (CSV)", # From snippet 1
    "download_filtered_data_excel": "üì• Download Filtered Observation Data (Excel)", # From snippet 1
    "label_observation_date": "Observation Date", # From snippet 1
    "filter_start_date": "Start Date", # From snippet 1
    "filter_end_date": "End Date", # From snippet 1
    "filter_teacher": "Filter by Teacher", # From snippet 1
    "subheader_teacher_performance": "Teacher Performance Over Time", # From snippet 1
    "info_select_teacher": "Select a teacher to view individual performance analytics.", # From snippet 1
    "info_no_obs_for_teacher": "No observations found for the selected teacher within the applied filters.", # From snippet 1
    "subheader_teacher_domain_trend": "{} Domain Performance Trend", # From snippet 1
    "subheader_teacher_overall_avg": "{} Overall Average Score (Filtered)", # From snippet 1
    "perf_level_very_weak": "Very Weak", # From snippet 1
    "perf_level_weak": "Weak", # From snippet 1
    "perf_level_acceptable": "Acceptable", # From snippet 1
    "perf_level_good": "Good", # From snippet 1
    "perf_level_excellent": "Excellent", # From snippet 1
    "plan_very_weak_overall": "Overall performance is Very Weak. A comprehensive support plan is required. Focus on fundamental teaching practices such as classroom management, lesson planning, and basic instructional strategies. Seek guidance from your mentor teacher and school leadership.", # From snippet 1
    "plan_weak_overall": "Overall performance is Weak. A support plan is recommended. Identify 1-2 key areas for improvement from the observation and work with your mentor teacher to develop targeted strategies. Consider observing experienced colleagues in these areas.", # From snippet 1
    "plan_weak_domain": "Performance in **{}** is Weak. Focus on developing skills related to: {}. Suggested actions include: [Specific action 1], [Specific action 2].", # From snippet 1
    "steps_acceptable_overall": "Overall performance is Acceptable. Continue to build on your strengths. Identify one area for growth to refine your practice and enhance student learning.", # From snippet 1
    "steps_good_overall": "Overall performance is Good. You demonstrate effective teaching practices. Explore opportunities to share your expertise with colleagues, perhaps through informal mentoring or presenting successful strategies.", # From snippet 1
    "steps_good_domain": "Performance in **{}** is Good. You demonstrate strong skills in this area. Consider exploring advanced strategies related to: {}. Suggested actions include: [Specific advanced action 1], [Specific advanced action 2].", # From snippet 1
    "steps_excellent_overall": "Overall performance is Excellent. You are a role model for effective teaching. Consider leading professional development sessions or mentoring less experienced teachers.", # From snippet 1
    "steps_excellent_domain": "Performance in **{}** is Excellent. Your practice in this area is exemplary. Continue to innovate and refine your practice, perhaps by researching and implementing cutting-edge strategies related to: {}.", # From snippet 1
    "no_specific_plan_needed": "Performance is at an acceptable level or above. No immediate support plan required based on this observation. Focus on continuous improvement based on your professional goals.", # From snippet 1
    "warning_fill_basic_info": "Please fill in Observer Name, Teacher Name, School Name, Grade, Subject, Gender, and Observation Date.", # More specific validation
    "warning_fill_all_basic_info": "Please fill in all basic information fields.", # Generic fallback
    "warning_numeric_fields": "Please enter valid numbers for Students, Males, and Females.", # Added string for numeric validation
    "success_pdf_generated": "Feedback PDF generated successfully.", # Added success message for PDF
    "download_feedback_pdf": "üì• Download Feedback PDF", # Added string for PDF download button label
    "checkbox_cleanup_sheets": "ü™ü Clean up unused LO sheets (no observer name)", # Added string for checkbox label
    "warning_sheets_removed": "Removed {} unused LO sheets.", # Added string for warning message
    "info_reloaded_workbook": "Reloaded workbook after cleanup.", # Added string for info message
    "info_no_sheets_to_cleanup": "No unused LO sheets found to clean up.", # Added string for info message
    "expander_guidelines": "üìò Click here to view observation guidelines", # Added string for expander label
    "info_no_guidelines": "Guidelines sheet is empty or could not be read.", # Added string for info message
    "warning_select_create_sheet": "Please select or create a valid sheet to proceed.", # Added string for warning message
    "label_overall_notes": "General Notes for this Lesson Observation", # Added missing string key


}

# Placeholder Arabic strings - REPLACE THESE WITH ACTUAL TRANSLATIONS
ar_strings = {
    "page_title": "ÿ£ÿØÿßÿ© ÿßŸÑÿ™ŸÇŸäŸäŸÖ ŸÑŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿßŸÑÿµŸÅŸäÿ©",
    "sidebar_select_page": "ÿßÿÆÿ™ÿ± ÿµŸÅÿ≠ÿ©:",
    "page_lesson_input": "ÿßÿØÿÆÿßŸÑ ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©",
    "page_analytics": "ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©",
    "title_lesson_input": "ÿ£ÿØÿßÿ© ÿ•ÿØÿÆÿßŸÑ ÿ≤Ÿäÿßÿ±ÿ© ÿµŸÅŸäÿ© ÿ£ÿ≥ÿ®ŸàÿπŸäÿ©",
    "info_default_workbook": "ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ŸÖÿµŸÜŸÅ ÿßŸÑŸÇÿßŸÑÿ® ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä:",
    "warning_default_not_found": "ÿ™ÿ≠ÿ∞Ÿäÿ±: ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÖÿµŸÜŸÅ ÿßŸÑŸÇÿßŸÑÿ® ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä '{}'. Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≠ŸÖŸäŸÑ ŸÖÿµŸÜŸÅ.",
    "error_opening_default": "ÿÆÿ∑ÿ£ ŸÅŸä ŸÅÿ™ÿ≠ ŸÖŸÑŸÅ ÿßŸÑŸÇÿßŸÑÿ® ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä:",
    "success_lo_sheets_found": "ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ {} ÿ£Ÿàÿ±ÿßŸÇ LO ŸÅŸä ÿßŸÑŸÖÿµŸÜŸÅ.",
    "select_sheet_or_create": "ÿ≠ÿØÿØ Ÿàÿ±ŸÇÿ© LO ŸÖŸàÿ¨ŸàÿØÿ© ÿ£Ÿà ÿ£ŸÜÿ¥ÿ¶ Ÿàÿßÿ≠ÿØÿ© ÿ¨ÿØŸäÿØÿ©:",
    "option_create_new": "ÿ•ŸÜÿ¥ÿßÿ° ÿ¨ÿØŸäÿØ",
    "success_sheet_created": "ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° Ÿàÿ±ŸÇÿ© ÿ¨ÿØŸäÿØÿ©: {}",
    "error_template_not_found": "ÿÆÿ∑ÿ£: ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ Ÿàÿ±ŸÇÿ© ÿßŸÑŸÇÿßŸÑÿ® 'LO 1' ŸÅŸä ÿßŸÑŸÖÿµŸÜŸÅ! ŸÑÿß ŸäŸÖŸÉŸÜ ÿ•ŸÜÿ¥ÿßÿ° Ÿàÿ±ŸÇÿ© ÿ¨ÿØŸäÿØÿ©.",
    "subheader_filling_data": "ŸÖŸÑÿ° ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÄ: {}",
    "label_observer_name": "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ±ÿßŸÇÿ®",
    "label_teacher_name": "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿπŸÑŸÖ",
    "label_teacher_email": "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÑŸÑŸÖÿπŸÑŸÖ",
    "label_operator": "ÿßŸÑŸÖÿ¥ÿ∫ŸÑ",
    "label_school_name": "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©",
    "label_grade": "ÿßŸÑÿµŸÅ",
    "label_subject": "ÿßŸÑŸÖÿßÿØÿ©",
    "label_gender": "ÿßŸÑÿ¨ŸÜÿ≥",
    "label_students": "ÿπÿØÿØ ÿßŸÑÿ∑ŸÑÿßÿ®",
    "label_males": "ÿπÿØÿØ ÿßŸÑÿ∞ŸÉŸàÿ±",
    "label_females": "ÿπÿØÿØ ÿßŸÑÿ•ŸÜÿßÿ´",
    "label_time_in": "ŸàŸÇÿ™ ÿßŸÑÿØÿÆŸàŸÑ",
    "label_time_out": "ŸàŸÇÿ™ ÿßŸÑÿÆÿ±Ÿàÿ¨",
    "label_lesson_duration": "üïí **ŸÖÿØÿ© ÿßŸÑÿØÿ±ÿ≥:** {} ÿØŸÇŸäŸÇÿ© ‚Äî _{}_",
    "duration_full_lesson": "ÿØÿ±ÿ≥ ŸÉÿßŸÖŸÑ",
    "duration_walkthrough": "ÿ¨ŸàŸÑÿ© ÿ≥ÿ±Ÿäÿπÿ©",
    "warning_calculate_duration": "Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ŸàŸÇÿ™ ÿßŸÑÿØÿÆŸàŸÑ ŸàŸàŸÇÿ™ ÿßŸÑÿÆÿ±Ÿàÿ¨ ŸÑÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿØÿ©.",
    "warning_could_not_calculate_duration": "ÿ™ÿπÿ∞ÿ± ÿ≠ÿ≥ÿßÿ® ŸÖÿØÿ© ÿßŸÑÿØÿ±ÿ≥.",
    "label_period": "ÿßŸÑŸÅÿ™ÿ±ÿ©",
    "label_obs_type": "ŸÜŸàÿπ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©",
    "option_individual": "ŸÅÿ±ÿØŸä",
    "option_joint": "ŸÖÿ¥ÿ™ÿ±ŸÉ",
    "subheader_rubric_scores": "ÿØÿ±ÿ¨ÿßÿ™ ÿßŸÑÿØŸÑŸäŸÑ",
    "expander_rubric_descriptors": "ÿ•ÿ±ÿ¥ÿßÿØÿßÿ™ ÿßŸÑÿØŸÑŸäŸÑ", # Needs verification
    "info_no_descriptors": "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ•ÿ±ÿ¥ÿßÿØÿßÿ™ ÿØŸÑŸäŸÑ ŸÖÿ™ÿßÿ≠ÿ© ŸÑŸáÿ∞ÿß ÿßŸÑÿπŸÜÿµÿ±.", # Needs verification
    "label_rating_for": "ÿßŸÑÿ™ŸÇŸäŸäŸÖ ŸÑŸÄ {}",
    "label_write_notes": "ŸÉÿ™ÿßÿ®ÿ© ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ŸÑŸÄ {}", # Guessed translation for notes label
    "checkbox_send_feedback": "‚úâÔ∏è ÿ•ŸÜÿ¥ÿßÿ° ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ (ŸÑŸÑŸÖŸÑŸÅ PDF)", # Guessed translation - renamed
    "button_save_observation": "üíæ ÿ≠ŸÅÿ∏ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©",
    "warning_fill_essential": "Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿ≠ŸÇŸàŸÑ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸÇÿ®ŸÑ ÿßŸÑÿ≠ŸÅÿ∏.",
    "success_data_saved": "ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ŸÅŸä ÿßŸÑŸÖÿµŸÜŸÅ.", # Guessed translation - simplified
    "error_saving_workbook": "ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿµŸÜŸÅ:",
    "download_workbook": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ÿßŸÑŸÖÿµŸÜŸÅ ÿßŸÑŸÖÿ≠ÿØÿ´",
    "feedback_subject": "ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑÿµŸÅŸäÿ©", # Needs verification
    "feedback_greeting": "ÿπÿ≤Ÿäÿ≤Ÿä {},\n\nÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ≤Ÿäÿßÿ±ÿ™ŸÉ ÿßŸÑÿµŸÅŸäÿ© ŸÖŸÜ {}.\n\n", # Needs verification
    "feedback_observer": "ÿßŸÑŸÖÿ±ÿßŸÇÿ®: {}\n", # Needs verification
    "feedback_duration": "ÿßŸÑŸÖÿØÿ©: {}\n", # Needs verification
    "feedback_subject_fb": "ÿßŸÑŸÖÿßÿØÿ©: {}\n", # Needs verification
    "feedback_school": "ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©: {}\n\n", # Needs verification
    "feedback_summary_header": "ÿ•ŸÑŸäŸÉ ŸÖŸÑÿÆÿµ ŸÑÿ™ŸÇŸäŸäŸÖÿßÿ™ŸÉ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿØŸÑŸäŸÑ:\n\n", # Needs verification
    "feedback_domain_header": "**{}: {}**\n", # Needs verification
    "feedback_element_rating": "- **{}:** ÿßŸÑÿ™ŸÇŸäŸäŸÖ **{}**\n", # Needs verification
    "feedback_descriptor_for_rating": "  *ÿ•ÿ±ÿ¥ÿßÿØÿßÿ™ ŸÑŸÑÿ™ŸÇŸäŸäŸÖ {}:* {}\n", # Guessed translation for guidance text
    "feedback_overall_score": "\n**ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿØÿ±ÿ¨ÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä:** {:.2f}\n\n", # Needs verification
    "feedback_domain_average": "  *ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑŸÖÿ¨ÿßŸÑ:* {:.2f}\n", # Needs verification
    "feedback_performance_summary": "**ŸÖŸÑÿÆÿµ ÿßŸÑÿ£ÿØÿßÿ°:**\n", # Needs verification
    "overall_performance_level_text": "ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: {}", # Guessed translation for overall level
    "feedback_domain_performance": "{}: {}\n", # Needs verification
    "feedback_support_plan_intro": "\n**ÿÆÿ∑ÿ© ÿßŸÑÿØÿπŸÖ ÿßŸÑŸÖŸàÿµŸâ ÿ®Ÿáÿß:**\n", # Needs verification
    "feedback_next_steps_intro": "\n**ÿßŸÑÿÆÿ∑Ÿàÿßÿ™ ÿßŸÑÿ™ÿßŸÑŸäÿ© ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ÿ©:**\n", # Needs verification
    "feedback_closing": "\nÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ Ÿáÿ∞Ÿá ÿßŸÑÿ™ŸÇŸäŸäŸÖÿßÿ™ÿå Ÿäÿ±ÿ¨Ÿâ ŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑŸÖÿµŸÜŸÅ ÿßŸÑŸÖÿ≠ÿØÿ´ ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ™ŸÅÿµŸäŸÑŸäÿ© ŸàŸÖÿ¨ÿßŸÑÿßÿ™ ÿßŸÑÿ™ÿ∑ŸàŸäÿ±.\n\n", # Needs verification
    "feedback_regards": "ŸÖÿπ ÿßŸÑÿ™ÿ≠Ÿäÿßÿ™,\nŸÅÿ±ŸäŸÇ ŸÇŸäÿßÿØÿ© ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©", # Needs verification
    "success_feedback_generated": "ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ (ŸÖÿ≠ÿßŸÉÿßÿ©):\n\n", # Needs verification
    "success_feedback_log_updated": "ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™.", # Guessed translation - simplified
    "error_updating_log": "ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ŸÅŸä ÿßŸÑŸÖÿµŸÜŸÅ:", # Needs verification
    "title_analytics": "ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑÿµŸÅŸäÿ©", # Needs verification
    "warning_no_lo_sheets_analytics": "ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ£Ÿàÿ±ÿßŸÇ 'LO ' ŸÅŸä ÿßŸÑŸÖÿµŸÜŸÅ ŸÑŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™.", # Needs verification
    "subheader_avg_score_overall": "ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿØÿ±ÿ¨ÿ© ŸÑŸÉŸÑ ŸÖÿ¨ÿßŸÑ (ÿπÿ®ÿ± ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™)", # Needs verification
    "info_no_numeric_scores_overall": "ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿØÿ±ÿ¨ÿßÿ™ ÿ±ŸÇŸÖŸäÿ© ÿπÿ®ÿ± ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÑÿ≠ÿ≥ÿßÿ® ŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÑ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ©.", # Needs verification
    "subheader_data_summary": "ŸÖŸÑÿÆÿµ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©", # Needs verification
    "subheader_filter_analyze": "ÿ™ÿµŸÅŸäÿ© Ÿàÿ™ÿ≠ŸÑŸäŸÑ", # Needs verification
    "filter_by_school": "ÿ™ÿµŸÅŸäÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©", # Needs verification
    "filter_by_grade": "ÿ™ÿµŸÅŸäÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿµŸÅ", # Needs verification
    "filter_by_subject": "ÿ™ÿµŸÅŸäÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸÖÿßÿØÿ©", # Needs verification
    "option_all": "ÿßŸÑŸÉŸÑ", # Needs verification
    "subheader_avg_score_filtered": "ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿØÿ±ÿ¨ÿ© ŸÑŸÉŸÑ ŸÖÿ¨ÿßŸÑ (ŸÖÿµŸÅŸâ)", # Needs verification
    "info_no_numeric_scores_filtered": "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÑŸÑŸÖÿ±ÿ¥ÿ≠ÿßÿ™ ÿßŸÑŸÖÿ≠ÿØÿØÿ© ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿØÿ±ÿ¨ÿßÿ™ ÿ±ŸÇŸÖŸäÿ© ŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÑ.", # Needs verification
    "subheader_observer_distribution": "ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖÿ±ÿßŸÇÿ®ŸäŸÜ (ŸÖÿµŸÅŸâ)", # Needs verification
    "info_no_observer_data_filtered": "ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ±ÿßŸÇÿ® ŸÑŸÑŸÖÿ±ÿ¥ÿ≠ÿßÿ™ ÿßŸÑŸÖÿ≠ÿØÿØÿ©.", # Needs verification
    "info_no_observation_data_filtered": "ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ŸÑŸÑŸÖÿ±ÿ¥ÿ≠ÿßÿ™ ÿßŸÑŸÖÿ≠ÿØÿØÿ©.", # Needs verification
    "error_loading_analytics": "ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ£Ÿà ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑŸÖÿµŸÜŸÅ ŸÑŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™:", # Needs verification
    "overall_score_label": "ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ©:", # Needs verification
    "overall_score_value": "**{:.2f}**", # Needs verification
    "overall_score_na": "**ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±**", # Needs verification
    "arabic_toggle_label": "ÿπÿ±ÿ∂ ÿ®ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Display in Arabic)", # Needs verification
    "feedback_log_sheet_name": "ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™", # Needs verification
    "feedback_log_header": ["Sheet", "Observer", "Teacher", "Email", "School", "Subject", "Date", "Overall Judgment", "Overall Score", "Summary Notes"], # Updated log headers - Guessed translation
    "download_feedback_log_csv": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ (CSV)", # Needs verification
    "error_generating_log_csv": "ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ŸÜÿ¥ÿßÿ° ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ CSV:", # Needs verification
    "download_overall_avg_csv": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÑ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ© (CSV)", # Needs verification
    "download_overall_avg_excel": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÑ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ© (Excel)", # Needs verification
    "download_filtered_avg_csv": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÑ ÿßŸÑŸÖÿµŸÅÿßÿ© (CSV)", # Needs verification
    "download_filtered_avg_excel": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ŸÖÿ™Ÿàÿ≥ÿ∑ÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÑ ÿßŸÑŸÖÿµŸÅÿßÿ© (Excel)", # Needs verification
    "download_filtered_data_csv": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑŸÖÿµŸÅÿßÿ© (CSV)", # Needs verification
    "download_filtered_data_excel": "üì• ÿ™ŸÜÿ≤ŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑŸÖÿµŸÅÿßÿ© (Excel)", # Needs verification
    "label_observation_date": "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©", # Needs verification
    "filter_start_date": "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ®ÿØÿ°", # Needs verification
    "filter_end_date": "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿßŸÜÿ™Ÿáÿßÿ°", # Needs verification
    "filter_teacher": "ÿ™ÿµŸÅŸäÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸÖÿπŸÑŸÖ", # Needs verification
    "subheader_teacher_performance": "ÿ£ÿØÿßÿ° ÿßŸÑŸÖÿπŸÑŸÖ ÿ®ŸÖÿ±Ÿàÿ± ÿßŸÑŸàŸÇÿ™", # Needs verification
    "info_select_teacher": "ÿ≠ÿØÿØ ŸÖÿπŸÑŸÖŸãÿß ŸÑÿπÿ±ÿ∂ ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑŸÅÿ±ÿØŸä.", # Needs verification
    "info_no_obs_for_teacher": "ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑŸÖÿπŸÑŸÖ ÿßŸÑŸÖÿ≠ÿØÿØ ÿ∂ŸÖŸÜ ÿßŸÑŸÖÿ±ÿ¥ÿ≠ÿßÿ™ ÿßŸÑŸÖÿ∑ÿ®ŸÇÿ©.", # Needs verification
    "subheader_teacher_domain_trend": "ÿßÿ™ÿ¨ÿßŸá ÿ£ÿØÿßÿ° ŸÖÿ¨ÿßŸÑ {}", # Needs verification
    "subheader_teacher_overall_avg": "ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿØÿ±ÿ¨ÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ŸÑŸÄ {} (ŸÖÿµŸÅŸâ)", # Needs verification
    "perf_level_very_weak": "ÿ∂ÿπŸäŸÅ ÿ¨ÿØÿßŸã", # Needs verification
    "perf_level_weak": "ÿ∂ÿπŸäŸÅ", # Needs verification
    "perf_level_acceptable": "ŸÖŸÇÿ®ŸàŸÑ", # Needs verification
    "perf_level_good": "ÿ¨ŸäÿØ", # Needs verification
    "perf_level_excellent": "ŸÖŸÖÿ™ÿßÿ≤", # Needs verification
    "plan_very_weak_overall": "ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿ∂ÿπŸäŸÅ ÿ¨ÿØÿßŸã. ÿ™ÿ™ÿ∑ŸÑÿ® ÿÆÿ∑ÿ© ÿØÿπŸÖ ÿ¥ÿßŸÖŸÑÿ©. ÿ±ŸÉÿ≤ ÿπŸÑŸâ ÿßŸÑŸÖŸÖÿßÿ±ÿ≥ÿßÿ™ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸäÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸÖÿ´ŸÑ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµŸÅÿå Ÿàÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿØÿ±ÿ≥ÿå ŸàÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸäÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©. ÿßÿ∑ŸÑÿ® ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ŸÖŸÜ ŸÖÿπŸÑŸÖŸÉ ÿßŸÑŸÖŸàÿ¨Ÿá ŸàŸÇŸäÿßÿØÿ© ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©.", # Needs verification
    "plan_weak_overall": "ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿ∂ÿπŸäŸÅ. ŸäŸàÿµŸâ ÿ®ÿÆÿ∑ÿ© ÿØÿπŸÖ. ÿ≠ÿØÿØ 1-2 ŸÖŸÜ ÿßŸÑŸÖÿ¨ÿßŸÑÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸÑŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿ© ŸàÿßÿπŸÖŸÑ ŸÖÿπ ŸÖÿπŸÑŸÖŸÉ ÿßŸÑŸÖŸàÿ¨Ÿá ŸÑÿ™ÿ∑ŸàŸäÿ± ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ŸÖÿ≥ÿ™ŸáÿØŸÅÿ©. ŸÅŸÉÿ± ŸÅŸä ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿßŸÑÿ≤ŸÖŸÑÿßÿ° ÿ∞ŸàŸä ÿßŸÑÿÆÿ®ÿ±ÿ© ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑŸÖÿ¨ÿßŸÑÿßÿ™.", # Needs verification
    "plan_weak_domain": "ÿßŸÑÿ£ÿØÿßÿ° ŸÅŸä **{}** ÿ∂ÿπŸäŸÅ. ÿ±ŸÉÿ≤ ÿπŸÑŸâ ÿ™ÿ∑ŸàŸäÿ± ÿßŸÑŸÖŸáÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ™ÿπŸÑŸÇÿ© ÿ®ŸÄ: {}. ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ÿ© ÿ™ÿ¥ŸÖŸÑ: [ÿ•ÿ¨ÿ±ÿßÿ° ŸÖÿ≠ÿØÿØ 1]ÿå [ÿ•ÿ¨ÿ±ÿßÿ° ŸÖÿ≠ÿØÿØ 2].", # Needs verification
    "steps_acceptable_overall": "ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ŸÖŸÇÿ®ŸàŸÑ. ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ®ŸÜÿßÿ° ÿπŸÑŸâ ŸÜŸÇÿßÿ∑ ŸÇŸàÿ™ŸÉ. ÿ≠ÿØÿØ ŸÖÿ¨ÿßŸÑŸãÿß Ÿàÿßÿ≠ÿØŸãÿß ŸÑŸÑŸÜŸÖŸà ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÖÿßÿ±ÿ≥ÿ™ŸÉ Ÿàÿ™ÿπÿ≤Ÿäÿ≤ ÿ™ÿπŸÑŸÖ ÿßŸÑÿ∑ŸÑÿßÿ®.", # Needs verification
    "steps_good_overall": "ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿ¨ŸäÿØ. ÿ£ŸÜÿ™ ÿ™ÿ∏Ÿáÿ± ŸÖŸÖÿßÿ±ÿ≥ÿßÿ™ ÿ™ÿπŸÑŸäŸÖŸäÿ© ŸÅÿπÿßŸÑÿ©. ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ŸÅÿ±ÿµ ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿÆÿ®ÿ±ÿ™ŸÉ ŸÖÿπ ÿßŸÑÿ≤ŸÖŸÑÿßÿ°ÿå ÿ±ÿ®ŸÖÿß ŸÖŸÜ ÿÆŸÑÿßŸÑ ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ÿ∫Ÿäÿ± ÿßŸÑÿ±ÿ≥ŸÖŸä ÿ£Ÿà ÿ™ŸÇÿØŸäŸÖ ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ŸÜÿßÿ¨ÿ≠ÿ©.", # Needs
